<center><div><h1>Permissions & Ownership in Linux التصاريح و الملكية في لينكس</h1></div></center>


## التصاريح Permissions
بنشوف بعض الرموز جنب الملفات في ال _Long listing_ 
زي 
`-rwx-w-r-x`
او
`drwx--xr-x`

سألت نفسك ايه الرموز دي وبتستخدم في ايه ؟

هي دي التصاريح او ال Permissions
ودي بتوضح الصلاحيات اللي محتاجها الاشخاص عشان يقدروا يتعملوا مع الملف او المجلد بشكل عام...

### بتتقسم التصاريح ل 3 فئات بالترتيب ده

- الشخص صاحب الملف - **USER**
- المجموعة صاحبة الملف - **GROUP**
- الغير - **OTHERS**

وكل فئة من الثلاثة فئات بتتقسم 3 اجزاء وهما
- التمكن من قراءة الملف - **Read**
- التمكن من التعديل على الملف - **Write**
- التمكن من تشغيل الملف -  **Execute**

بشكل عملي اكتر هنشوف المثال ده

```sh
-rwxrwxrwx  root root  394 Mar  10 08:48 README.md
```
ده ملف اسمه README.md عليه كل الصلاحيات لكل من user + group + others

كل 3 اجزاء من الحروف دي بيتسمى _Octet_  , بيخص فئة من اصحاب التصاريح بالترتيب اللي قولنا عليه

يعني `rwxrwxrwx` دي عبارة عن 3 اجزاء كل جزء منهم rwx rwx rwx
- اول جزء خاص بالUSER او صاحب الملف وهنا هو معاه تصاريح read + write + execute [rwx]
- تاني جزء خاص بالGROUP او المجموعة اللي مصرح لأعضائها التعامل على الملف وبرده معاهم نفس التصاريح read + write + execute [rwx]
- تالت جزء خاص بالOTHERS او اي حد غير صاحب الملف و المجموعة صاحبة الملف، وهنا صلاحيات الغير برده نفس الوضع read + write + execute [rwx]

بمجرد مانضمهم جنب بعض هيطلعوا في الاخر
rwxrwxrwx

### ازاي اقدر احدد الصلاحيات دي ؟


الامر الاساسي اللي هنستخدمة في التصاريح هو **chmod** بمعنلا Change Mode

الامر ده هو اللي بيخليك تقدر تغير الصلاحيات اللي عايزها بشرط انك تكون اصلا عندك الصلاحية لاستخدامة على الملف

### طريقة استخدام ال chmod

- في حل من اتنين ! اما انك تستخدم الحروف نفسها ، وده عن طريق استخدام ال flags
- او انك تستخدم الارقام المساوية لكل صلاحية من الصلاحيات دي عشان تحدد كل صلاحية خاصة بكل فئة

#### [1] استخدم ال Flags
مثال:

```sh
chmod u+rwx <file|directory>
```
المثال اللي فات ده كان فيه 3 اجزاء

  - اولا جزء:  **chmod** الامر الاساسي للتغير
  - ثاني جزء: **u+rwx** التصريحات اللي هتطبق على الملف
  - آخر جزء: **file|directory** الملف او المجلد اللي هنطبق عليه التصاريح
  
طيب ايه هي ال الرموز بتاعة الصلاحيات دي ؟ وايه علامة + وايه المقصود بيها ؟

مبدأيا احنا قلنا ان كل فئة من ال 3 فئات اللي عندنا ( USER - GROUP - OTHER ) ليه 3 صلاحيات وهما [rwx]

طيب ايه بقى ال _u_ 

ببساطة ال _u_ هي اختصار ل User ودي معناها صاحب الملف او ال OWNER

وهنا احنا بنطلب نضيف للUser الصلاحيات كلها وهي READ WRITE EXECUTE

طيب احنا دلوقتي برده مش عارفين ازاي نستخدم الامر ده ؟

انا هقولك تستخدمه ازاي ..

**اولا**: هنسخدم الامر الاساسي بتاعنا وهو `chmod`

**ثانيا**: هنضيف عليه الفئات اللي احنا عايزين نغير او نعدل تصاريحها

_كل فئة بيرمز ليها برمز معين عشان نحدد التصاريح ودي الرموز الخاصة بكل فئة_ :

 - اليوزر USER او صاحب الملف و بيرمز ليه بالحرف **u**
 - المجموعة GROUP او المجموعة المالكة للملف وبيرمز ليها بالحرف **g**
 - الغير OTHERS و المقصود بيهم اي شخص غير صاحب الملف او المجموعى المالكة للملف وبيرمز ليهم بالحرف **o**
 - اخر رمز هو الرمز اللي بيشمل كل الفئات او Everyone ، بمعنى لو عايز ادي صلاحية لكل الفئات ، بدل ما استخدم **ugo** هنستخدم الرمز **a**


يعني مثلا لو عايز اعدل الصلاحيات للغير يبقى انا هستخدم الامر `chmod o`

او مثلا عايز اعدل الصلاحيات لكل الفئات، يبقى هنستخدم الامر `chmod a`

**ثالثا**: هنعدل الصلاحيات للفئة المحددة سواء هنضيفها او هنشيل منها او هنغيرها خالص

عشان نعدل الصلاحيات اما اننا هنضيف او نشيل صلاحية او اكتر ، او حتى اننا نغير الصلاحيات الموجودة كلها وده هيكون باستخدام حاجه من ثلاثة اما `-` او `+` او `=`

- لو هنضيف صلاحية يبقى هنستخدم `+` وهنا احنا بنضيف صلاحية جديدة 

مثلا: `chmod o+x` فالامر ده كده بنضيف صلاحية execute للغير

- لو هنشيل صلاحية يبقى هنستخدم `-` وهنا احنا بنشيل صلاحية من صلاحيات الفئة الموجودة حاليا

مثلا : لو عندنا الصلاحيات بتاعة الجروب rwx وعايزين نشيل منها مثلا ال write يبقى هنستخدم `chmod g-w`

- اما بقى لو عايزين نغير الصلاحيات الحالية كلها لفئة معينه يبقى هنستخدم `=`

مثلا: لو عندنا الصلاحيات _rwx_ لكل الفئات وعايزين نغيرها تبقى مثلا read بس، يبقى هنستخدم `chmod a=r`

**رابعا**: ودي اخر حاجة وهي اننا هنضيف اسم الملف او المجلد اللي هيتبطق عليه الصلاحية 

بمعنى اننا لو عايزين مثلا نضيف صلاحيات read + write للمجموعة المالكة GROUP  على ملف اسمة file.txt هنسخدم الامر بالشكل ده
```sh
chmod g+rw file.txt
```
نفس الوضع لو حبينا مثلا نشيل صلاحيات ال write + execute من الغير OTHERS على ملف اسمة file.txt هنستخدم الامر بالشكل ده
```sh
chmod o-wx file.txt
```
ونفس الوضع لو حبينا نغير كل صلاحيات صاحب الملف او ال OWNER USER من r-x ل -rw على ملف اسمه file.txt هنستخدم الامر بالشكل ده
```sh
chmode u=rw file.txt
```


---
##### طيب في حال اننا عايزين نغير صلاحيات لفئات مختلفه ؟

اما اننا نستخدم الصلاحيات ومابينهم فاصلة `,` او اننا نستخدم النوع التاني وهو _Octal Permissions_

**النوع الاول** هيكون زي الحالات اللي فاتت يعني مثال:

- عايزين نغير صلاحيات الغير من rwx ل --r
- عايزين نغير صلاحيات الجروب من r-x ل rwx
- عايزين نغير صلاحيات اليوزر من -rw ل rwx

هنا احنا قدامنا حلول كتير ، اما اننا نستخدم اضافة او حذف `-` او `+` للصلاحيات , او نغير الصلاحيات حسب ما احنا عايزين باسخدام `=`
يعني :

في حالة التغيير
```sh
chmod ug=rwx,o=r *
```
او
```sh
chmod u=rwx,g=rwx,o=r *
```
الحالتين نفس النتيجة بس طالما الصلاحيات واحدة فممكن اننا نحط اسماء الفئات جنب بعض.

في حالة الاضافة والحذف
```sh
chmod u+x,g+w,o-wx
```

**النوع الثاني** وهو باستخدام الارقام او الOctets
#### [2] تغير الصلاحيات بالـ Octal Permission

وده بيكون اسهل في حالة انك بتعدل الصلاحيات لكذا فئة عشان بيكون استخدامة مقتصر على عدد الBytes اللي هتتغير في كل Octet عشان تدي الصلاحيات المطلوبة

ايه ياعم الكلام التقيل اللي بتقوله ده !! 

خليني ابسطلك الامر شوية ...

احنا عندنا الصلاحيات زي ماقولنا بتنقسم ل 3 فئات وكل فئة ليها 3 انواع من الصلاحيات read + write + execute وقولنا ان الصلاحيات بتبقى على هيئة ال 3 رموز اللي بترمز
للصلاحيات وهي rwx

عشان تقدر تستخدم الصلاحيات بشكل رقمي بدلنا ال 3 رموز دول ب 7octets كل رمز منهم ليه قيمة بتساويه كالتالي:

|:Read - r :|:Write - w:|:Execute - x:|
|:---:|:---:|:---:|
| 4 octets | 2 octets | 1 octet |

لو حسبناهم هنلاقيهم مجموعهم 7 ، وبكده احنا بنحسب الصلاحيات حسب الرقم اللي هنستخدمة

بمعنى :
- لو انا اديت صلاحية برقم 7 معناه 4 + 2 + 1 يعني Full permission يبقى كده الصلاحية دي بتساوي rwx
- طيف انا مثلا اديت الصلاحية 1 .. هنلاقي ان رقم 1 بيساوي Execute يبقى انا كده بستخدم الصلاحية اللي هي x
- طيب في حالة الـ 4 .. مافيش رقمين هنجمعهم يكون ناتجهم 4 لكن Read بتساوي 4 يبقى انا كده بعمل صلاحية r
- طيب في حالة الـ 5 ؟ او الـ 6 ؟ او الـ 3 ؟ .. اي حالة من دول هي ناتج جمع حالتين يعني ال 5 مثلا ناتج جمع 4 + 1 يعني rx و ال 6 معناها ناتج جمع 4 + 2 يعني rw و هكذا زززز
- طيب في حالة اني مش عايز ادي صلاحيات خالص ؟ هستخدم الرقم 0

طيب انا كده هقدر استخدم ال 7octets دول مع كل الفئات ازاي ؟

ببساطة اي رقم مابين 111 لحد 777 هيكون Octal permission وضيف عليهم الرقم 000 

اشمعنا طيب مابين 111 لحد 777 ؟

ببساطة احنا كل فئة ليها جزء من 1 لحد 7 الجزء ده بيحدد تصاريح الفئة دي، وزي ماقولنا قبل كده احنا بنرتب التصاريح USER|GROUP|OTHERS فاحنا كل فئة من دول بترتيبها هتاخد الصلاحيات اللي بيساويها الرقم بتاعها في الترتيب

بمعنى اول رقم على الشمال هو الرقم الخاص بصلاحيات ال USER او OWNER الرقم اللي في النص هو الرقم الخاص بصلاحيات ال GROUP و آخر رقم اللي على اليمين هو الرقم الخاص بصلاحيات ال OTHERS

طيب هنستخدمه ازاي ال Octal permission ؟ 

ببساطة نفس الطريقة اللي استخدمناها مع ال Flags لو هنزود permission هنستخدم `+` ولو هنشيل بيرميشن هنستخدم `-` ولو هنعدل التصريح كله نستخدم `=` او من غير اي علامات هيغير التصريح كله

طيب ناخد مثال ؟

انا عندي ملف اسمه file.txt وعايز ادي الصلاحيات دي:
- USER : rwx 
- GROUP : r-x
- OTHERS : r--

هنحول الرموز بتاعتنا لأرقام وفقا للجدول اللي فوق ونجمعهم هنلاقي النتيجة عندن بقت :
- USER = 4+2+1 = 7
- GROUP = 4+1 = 5
- OTHERS = 4+0+0 = 4

كده النتيجة عندنا هتبقى 754 و اللي بتساوي `--rwxr-xr` 

كل اللي هعمله
```sh
chmod 754 file.txt
```
كده انا غيرت صلاحيات الملف كلها وبقت بتساوي 754 او `--rwxr-xr`

---
ودي جداول هتوضح اكتر التفاصيل


|: Permission :|: Symbol :|: Octal Number :|
|:---:|:---:|:---:|
| READ | r | 4 |
| WRITE | w | 2 |
| EXECUTE | x | 1 |

|: USER :|: Symbol :|
|:---:|:---:|
| OWNER | u |
| GROUP(OWNER) | g |
| OTHERS | o |
| EVERYBODY | a |

|: Everybody (a) :|: USER (u) :|: GROUP (g) :|: OTHERS (o) :|
|:---:|:---:|:---:|:---:|
|rwxrwxrwx| rwx | rwx | rwx |
|777| 7 | 7 | 7 |
| |FULLACCESS|FULLACCESS|FULLACCESS|
|rw-r-xr--| rw- | r-x | r-- |
|654| 6 | 5 | 4 |
| | READ/WRITE | READ/EXECUTE| READ |

---
اتمنى اكون وضح الجزء ده بشكل كويس ..


---
# الملكية Ownership

وهي الجزء التاني اللي ممكن تلاحظة انه موجود على كل ملف وانت بتستخدم ال Long List format زي كده
```sh
-rwxrwxrwx  root root  394 Mar  10 08:48 README.md
```
ده ملف اسمه README.md هنلاحظ مكتوب root root بعد الصلاحيات مباشرة .. ايه root root ؟

ببساطة احنا اتكلمنا فوق عن الصلاحيات وقولنا اننا بنحدد الصلاحيات ل 3 فئات وهما ال OWNER و ال GROUP و ال OTHERS

### طيب احنا بنعرف الفئات دي ازاي ؟ وبنحددها ازاي ؟

تعالى اعرفك كل حاجه عن الملكية او فئات المستخدمين ..

لو بصينا على المثال اللي فوق هنلاقي بعد الصلاحيات على طول اسم اليوزر root اتكرر مرتين .. 

ده معناه ان الملف ده مملوك او ال OWNER بتاعه اسمه root و الجروب المالك او ال OWNER GROUP اللي عندها صلاحيات عليه اسمها برده root

وده ترتيبا بيكون USER  GROUP بعد الصلاحيات على طول ..

### طيب هو مين اللي عمل الملف بالصلاحيات دي ؟

اي ملف بيتعمل اما انه بيتعمل عن طريق يوزر وبكده بيكون هو المالك ليه ، والمجموعة اللي بيكون ليها الصلاحيات على الملف هي المجموعة الاساسية لليوزر،
او ان الملف يكون آخد الصلاحيات بتاعته عن طريق استخدام أمر اسمه `chown` او Change Owner

## ازاي اقدر استخدم _chown_

عشان تستخدم ال change owner محتاج انك تحدد انت عايز تغير ايه ؟ هل هتغير المالك نفسه ؟ ولا المجموعة المالكة ليه ؟ ولا الاتنين ؟

ببساطة .. لو انا مثلا عايز اغير اسم المالك من root لـ burham مثلا لمجلد كامل وكل المجلدات الموجودة فيه واللي مكانه `/path/to/directory/` ، كل اللي عليا اني اعمله اسخدم
```sh
chown burham -R /path/to/directory/*
```

بالامر ده انا غيرت ملكية المجلد وكل اللي موجود جواه من اليوزر القديم اللي كان مالك ليه واصبح المالك الجديد burham

طيب لو حابب اغير ملكية المجموعة بس بنفس تفاصيل المثال اللي فوق وهنستخدم مجموعة مثلا اسمها admins كل اللي هعمله اني هستخدم نفس الامر بتغيير بسيط بأستخدام `:` قبل الاسم بتاع المجموعة
```sh
chown :admins -R /path/to/directory/*
```

طيب كده احنا غيرنا اليوزر لوحده والمجموعى لواحدها ماينفعش نغير الاتنين مع بعض ؟ ينفع طبعا .. كل اللي عليك ان تجمع الطرفين مع بعض بالشكل ده`user:group`
```sh
chown burham:admins -R /path/to/directory/*
```

طيب لو عايز اطبق ده على ملف واحد بس ؟ هنشيل الجزء الاخير ونبدله بأسم الملف زي كده
```sh
chown burham:admins file.txt
```

وبكده يبقى انت عرفت كل اللي محتاجه عن تغير اليوز والجروب وعرفت ازاي تستخدم الصلاحيات للملفات والمجلدات وتقدر تتعامل بمنتهى البساطة مع الLinux structure

لو محتاج اي حاجه ؟ تقدر تتواصل معايا على طول او تسيب كومنت هنا على الملف

WhatsApp: wa.me/201102423786?txt=Hello
Linkedin: linkedin.com/in/burham

Burham B. Soliman
